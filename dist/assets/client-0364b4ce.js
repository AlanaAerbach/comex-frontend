import"./moment-9c7c83e1.js";/* empty css              */import{C as u}from"./product-31b879c5.js";document.getElementById("btn_cep").onclick=M;const n=document.getElementById("form_client"),m="http://localhost:3000";n.addEventListener("submit",e=>{e.preventDefault();const t=new u(n.client_name.value,n.client_cpf.value,n.client_birth_date.value,n.client_email.value,n.client_contact.value,n.client_cep.value,n.client_address.value,n.client_number.value,n.client_complement.value,n.client_district.value,n.client_city.value,n.client_state.value),i=n.getElementsByTagName("input");O(t),console.log(t);for(let o=0;o<i.length;o++){const a=i[o];a.value=""}n.client_name.focus()});const p=document.querySelectorAll("input");p.forEach(e=>{e.addEventListener("blur",t=>{v(t.target)})});function v(e){const t=e.dataset.tipo;r[t]&&r[t](e),e.validity.valid?(e.parentElement.classList.remove("input_container_invalid"),e.parentElement.querySelector(".message_error").innerHTML=""):(e.parentElement.classList.add("input_container_invalid"),e.parentElement.querySelector(".message_error").innerHTML=C(t,e))}const f=["valueMissing","typeMismatch","patternMismatch","customError"],g={client_name:{valueMissing:"Digite seu nome completo.",customError:"O nome digitado deve ter pelo menos 2 caracteres."},client_cpf:{valueMissing:"O campo de CPF não pode estar vazio.",customError:"O CPF digitado não é válido."},client_email:{valueMissing:"O campo de email não pode estar vazio.",typeMismatch:"O email digitado não é válido",customError:"O email digitado não é válido."},client_cep:{valueMissing:"O campo de CEP não pode estar vazio.",patternMismatch:"O CEP digitado não é válido.",customError:"O CEP não foi encontrado."},client_address:{valueMissing:"O campo de logradouro não pode estar vazio."},client_district:{valueMissing:"O campo de cidade não pode estar vazio."},client_city:{valueMissing:"O campo de cidade não pode estar vazio."},client_state:{valueMissing:"O campo de estado não pode estar vazio."}};function _(e){let t="";(!e.value||e.value.length<3)&&(t="O nome digitado deve ter pelo menos 2 caracteres."),e.setCustomValidity(t)}function y(e){let t="",i=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;(!e.value||!i.test(e.value))&&(t="O email digitado não é válido"),e.setCustomValidity(t)}n.client_contact.addEventListener("keyup",e=>{let t=e.target;t.value=E(t.value)});function E(e){return e?(e=e.replace(/\D/g,""),e=e.replace(/(\d{2})(\d)/,"($1) $2"),e=e.replace(/(\d)(\d{4})$/,"$1-$2"),e):""}n.client_cep.addEventListener("keyup",e=>{let t=e.target;t.value=h(t.value)});function h(e){return e?(e=e.replace(/\D/g,""),e=e.replace(/(\d{5})(\d)/,"$1-$2"),e=e.replace(/(-\d{3})\d+?$/,"$1"),e):""}const r={client_name:e=>_(e),client_cpf:e=>c(e),client_email:e=>y(e),client_cpf:e=>c(e)};function C(e,t){let i="";return f.forEach(o=>{t.validity[o]&&(i=g[e][o])}),i}async function M(){let e=n.client_cep.value,t=document.getElementById("erro");t.innerHTML="";try{let o=await(await fetch(`https://viacep.com.br/ws/${e}/json/`)).json();if(o.erro)throw Error("CEP inexistente!");console.log(o),n.client_address.value=o.logradouro,n.client_district.value=o.bairro,n.client_city.value=o.localidade,n.client_state.value=o.uf}catch{t.innerHTML="<p>CEP inválido. Tente novamente!</p>"}}function O(e){fetch(`${m}/clientes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(t=>{alert(`Cliente ${e.name} cadastrado com sucesso.`),n.client_name.value="",n.client_name.focus()}).catch(t=>{alert("Não foi possível salvar o cliente! Aguarde uns minutos e tente novamente.")})}function c(e){console.log(e.value);const t=e.value.replace(/\D/g,"");let i="";(!$(t)||!P(t))&&(i="O CPF digitado não é válido"),e.setCustomValidity(i)}function $(e){const t=["00000000000","11111111111","22222222222","33333333333","44444444444","55555555555","66666666666","77777777777","88888888888","99999999999"];let i=!0;return t.forEach(o=>{o==e&&(i=!1)}),i}function P(e){return s(e,10)}function s(e,t){if(t>=12)return!0;let i=t,o=0;const a=e.substr(0,t-1).split(""),d=e.charAt(t-1);for(let l=0;i>1;i--)o=o+a[l]*i,l++;return d==w(o)?s(e,t+1):!1}function w(e){let t=e%11;return t>=2?11-t:0}
